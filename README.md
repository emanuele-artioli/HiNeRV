# **Streamlined HiNeRV Encoder**

This is a user-friendly fork of the official [HiNeRV repository](https://github.com/hmkx/HiNeRV) (NeurIPS 2023).

This version provides a streamlined setup and usage workflow, including:

* A robust, one-command Conda environment setup.  
* An automated script (`run_hinerv.sh`) to handle video preprocessing and encoding in a single step.  
* Automatic video resolution detection.

## **1\. Installation**

The entire environment setup is handled by a single script.

**Prerequisites:** You must have `conda` installed on your system.

First, clone this repository:
```
git clone https://github.com/emanuele-artioli/HiNeRV.git
cd HiNeRV
```
Then, run the installation script. This will create a new Conda environment named `hinerv` and install all necessary dependencies correctly.
```
chmod +x install.sh  
./install.sh
```
The installation is now complete.

## **2\. Usage**

To use the encoder, you first need to activate the Conda environment in your terminal.
```
conda activate hinerv
```
### **Basic Encoding**

The primary way to use this repository is through the `run_hinerv.sh` script. At its simplest, you just need to provide a path to your video file.

# Make the script executable (only need to do this once) 
``` 
chmod +x run_hinerv.sh
```
# Run the encoding process on your video
```  
./run_hinerv.sh -i /path/to/my_video.mp4
```
The script will automatically:

1. Create an output directory named `hinerv_output/my_video`.  
2. Convert `my_video.mp4` into a sequence of PNG frames.  
3. Detect the video's resolution (e.g., 1920x1080).  
4. Find the corresponding HiNeRV configuration files for that resolution.  
5. Run the HiNeRV training process to encode the video.  
6. Save the final trained model (the compressed "bitstream") into the output directory.

### **Advanced Options**

The `run_hinerv.sh` script has several options to customize its behavior:

| Flag | Argument | Description | Default |
| :---- | :---- | :---- | :---- |
| `-i` | `<path>` | **(Required)** Path to the input. Can be a video file (e.g., `.mp4`) or a directory of pre-existing PNG frames. |  |
| `-m` | `<S/L>` | The model size to use. `S` for the small model, `L` for the large model. | `S` |
| `-o` | `<dir_path>` | The base directory where all output folders will be created. | `hinerv_output` |
| `-b` | `<number>` | The batch size to use for training. | `144` |

**Example with options:**

# Use the large model and save results in a custom directory
```  
./run_hinerv.sh -i /path/to/my_video.mp4 -m L -o /data/hinerv_runs
```
### **Important: Resolution Configuration**

HiNeRV requires specific configuration files for each video resolution. This repository includes the default configs provided by the authors (e.g., for 1920x1080).

If you use a video with a resolution for which no config exists (e.g., 1280x720), the `run_hinerv.sh` script will stop and print an error message telling you which files you need to create.

To do this, navigate to the `cfgs/` directory, copy the files for the closest existing resolution, rename them to match your video's resolution, and adjust the parameters inside if necessary.

### **Evaluation (Decoding)**

To decode your video (i.e., reconstruct the frames from the trained model), please follow the instructions in the original [HiNeRV README](https://www.google.com/search?q=https://github.com/hmkx/HiNeRV/blob/main/README.md%23evaluation), using the model path generated by the `run_hinerv.sh` script.

